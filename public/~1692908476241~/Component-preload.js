//@ui5-bundle com/perezjquim/ytc/pwa/Component-preload.js
jQuery.sap.registerPreloadedModules({
"version":"2.0",
"modules":{
	"com/perezjquim/ytc/pwa/Component.js":function(){sap.ui.define(["sap/ui/core/UIComponent","sap/ui/Device"],function(t,i){"use strict";return t.extend("com.perezjquim.ytc.pwa.Component",{metadata:{manifest:"json"},init:function(){t.prototype.init.apply(this,arguments);this.getRouter().initialize()}})});
},
	"com/perezjquim/ytc/pwa/controller/App.controller.js":function(){sap.ui.define(["./util/BaseController","sap/ui/core/routing/History","sap/ui/core/Fragment","sap/ui/util/Storage","sap/ui/Device","./util/SWHelper"],function(t,e,n,o,s,i){"use strict";return t.extend("com.perezjquim.ytc.pwa.controller.App",{onInit:function(t){const e=new i(this);e.init()},onHomeButtonPress:function(t){const e=t.getSource();const n=e.getParent();const o=n.getSideContent();const s=o.getItem();const i=s.getItems();const c=i.find(function(t){const e=t.getKey();return e=="Home"});s.fireItemSelect({item:c})},onMenuButtonPress:function(t){const e=t.getSource();const n=e.getParent();const o=n.getSideExpanded();n.setSideExpanded(!o)},onNavigationItemSelect:function(t){const e=t.getParameter("item");const n=e.getKey();this.navTo(n);const o=s.system.phone;if(o){const e=t.getSource();const n=e.getParent();n.setSideExpanded(false)}},onNavButtonPress:function(t){this.navBack()}})});
},
	"com/perezjquim/ytc/pwa/controller/CropNDownload.controller.js":function(){sap.ui.define(["./util/BaseController"],function(t){"use strict";return t.extend("com.perezjquim.ytc.pwa.controller.CropNDownload",{API_BASE_URL:"https://perezjquim-ytc.herokuapp.com",onPrepareVideo:async function(){this.setBusy(true);const t=this.byId("ytc-wizard");const e=this.getModel("prompt");const o=e.getProperty("/split");var s=[];try{const c=decodeURIComponent(e.getProperty("/url"));const a=e.getProperty("/start_time");const r=e.getProperty("/end_time");if(o){const t=new Date(`1970-01-01 00:${a}`);const o=new Date(`1970-01-01 00:${r}`);const i=e.getProperty("/split_interval");const d=new Date(`1970-01-01 00:${i}`);const l=Number(d.getMinutes());const u=Number(d.getSeconds());while(true){const e=`${t.getMinutes()}:${t.getSeconds()}`;t.setMinutes(t.getMinutes()+l);t.setSeconds(t.getSeconds()+u);var n="";if(t.getTime()<o.getTime()){n=`${t.getMinutes()}:${t.getSeconds()}`;s.push(await this._downloadVideo(c,e,n))}else{n=`${o.getMinutes()}:${o.getSeconds()}`;s.push(await this._downloadVideo(c,e,n));break}}}else{s.push(await this._downloadVideo(c,a,r))}const d=await Promise.all(s);const l=this.getModel("video_blobs");var i=[];d.forEach(async function(e){if(e.ok){const t=e.headers.get("content-disposition").split("filename=")[1].split(";")[0];const o=await e.blob();const s=new Blob([o],{type:"application/octet-stream"});const n=window.URL.createObjectURL(s);i=i.concat([{file_name:t,blob_url:n}]);i.sort((t,e)=>t["file_name"]>e["file_name"]?1:-1);l.setData(i)}else{const o=await e.text();console.warn(o);this.toast(o);t.previousStep()}}.bind(this))}catch(e){console.warn(e);this.toast(e);t.previousStep()}this.setBusy(false)},onParamChanged:async function(t){const e=this.byId("ytc-wizard");e.previousStep();const o=this.getModel("video_blobs");o.setData([]);const s=t.getSource();const n=s.getBinding("value")||s.getBinding("selected");const i=n.getPath();switch(i){case"/url":const t=this.getModel("prompt");const e=decodeURIComponent(t.getProperty("/url"));const o=this.getModel("video_info");if(e){const s=this.getModel("misc");s.setProperty("/is_fetching_video_info",true);const n=(new Date).getTime();const i=`${this.API_BASE_URL}/get-video-info?url=${e}&=${n}`;try{const e=await fetch(i);if(e.ok){const s=await e.json();o.setData(s);if(!t.getProperty("/end_time")){var c=s.duration;if(c.length>5){c=c.substr(c.length-5)}const t=this.getModel("prompt");t.setProperty("/end_time",c)}}else{o.setData({});const t=await e.text();console.warn(t);this.toast(t)}}catch(t){console.warn(t);o.setData({})}s.setProperty("/is_fetching_video_info",false)}else{o.setData({})}break;default:break}},onPressDownload:function(t){const e=t.getSource();const o=e.getBindingContext("video_blobs");const s=o.getProperty("file_name");const n=o.getProperty("blob_url");const i=document.createElement("a");i.setAttribute("href",n);i.setAttribute("download",s);i.click()},_downloadVideo:async function(t,e,o){const s=(new Date).getTime();const n={url:t,start_time:e,end_time:o};const i=new URLSearchParams(n);const c=decodeURIComponent(i.toString());const a=`${this.API_BASE_URL}/crop-video?${c}&=${s}`;return fetch(a)}})});
},
	"com/perezjquim/ytc/pwa/controller/Home.controller.js":function(){sap.ui.define(["./util/BaseController"],function(e){"use strict";return e.extend("com.perezjquim.ytc.pwa.controller.Home",{})});
},
	"com/perezjquim/ytc/pwa/controller/util/BaseController.js":function(){sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/core/BusyIndicator","sap/m/MessageToast"],function(t,e,o,n){"use strict";return t.extend("com.perezjquim.ytc.pwa.controller.util.BaseController",{toast:function(t){n.show(t)},setBusy:function(t){if(t){o.show(0)}else{o.hide()}},getModel:function(t){const e=this.getOwnerComponent();const o=e.getModel(t);return o},attachPatternMatched(t,e){const o=this.getOwnerComponent();const n=o.getRouter();const s=n.getRoute(t);s.attachPatternMatched(e)},getConfig:function(t){const e=this.getModel("config");const o=e.getProperty(`/${t}`);return o},navTo:function(t,e,o){const n=this.getOwnerComponent();const s=n.getRouter();return s.navTo(t,e,o)},getText:function(t){const e=this.getModel("i18n");const o=e.getResourceBundle();const n=o.getText(t);return n},navBack:function(){const t=e.getInstance();const o=t.getPreviousHash();if(o){window.history.go(-1)}else{this.navTo("Home",{},true)}},getStorage:function(){return window.localStorage},clearModel:function(t){const e=this.getModel(t);const o=e.getData();for(var n in o){o[n]=""}e.setData(o)}})});
},
	"com/perezjquim/ytc/pwa/controller/util/SWHelper.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){return e.extend("com.perezjquim.ytc.pwa.controller.util.SWHelper",{_oController:null,constructor:function(e){this._oController=e},init:function(){this._cleanup();this._registerSW();window.addEventListener("beforeunload",this._cleanup.bind(this))},_registerSW:function(){if(navigator.serviceWorker){navigator.serviceWorker.register("/sw.js")}},_cleanup:function(){if(navigator.serviceWorker){navigator.serviceWorker.getRegistrations().then(function(e){for(let r of e){r.unregister()}})}}})});
},
	"com/perezjquim/ytc/pwa/i18n/i18n.properties":'appTitle=YTC\nappDescription=YTC\n\nHome=Home\nCropNDownload=Crop+Download\nurl=YT URL\nstart_time=Start time (XX:XX)\nend_time=End time (XX:XX)\ndownload=Download\n\nvideo_info=Video information\ntitle=Title\nauthor=Uploaded by\nthumbnail=Thumbnail\nduration=Duration\n\nstep_params=Parameters\nstep_preview+dl=Preview + Download\n\nsplit=Split',
	"com/perezjquim/ytc/pwa/manifest.json":'{"_version":"1.12.0","sap.app":{"id":"com.perezjquim.ytc.pwa","type":"application","i18n":"i18n/i18n.properties","applicationVersion":{"version":"1.0.0"},"title":"{{appTitle}}","description":"{{appDescription}}","sourceTemplate":{"id":"servicecatalog.connectivityComponentForManifest","version":"0.0.0"},"dataSources":{}},"sap.ui":{"technology":"UI5","icons":{"icon":"images/icon.png","favIcon":"images/icon.png","phone":"images/icon.png","phone@2":"images/icon.png","tablet":"images/icon.png","tablet@2":"images/icon.png"},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"rootView":{"viewName":"com.perezjquim.ytc.pwa.view.App","type":"XML","async":true},"dependencies":{"minUI5Version":"1.52.16","libs":{"sap.ui.layout":{},"sap.ui.core":{},"sap.m":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"com.perezjquim.ytc.pwa.i18n.i18n"}},"prompt":{"type":"sap.ui.model.json.JSONModel","uri":"model/prompt.json"},"navigation":{"type":"sap.ui.model.json.JSONModel","uri":"model/navigation.json"},"misc":{"type":"sap.ui.model.json.JSONModel","uri":"model/misc.json"},"video_info":{"type":"sap.ui.model.json.JSONModel"},"video_blobs":{"type":"sap.ui.model.json.JSONModel"}},"resources":{"css":[{"uri":"css/extra.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","viewType":"XML","async":true,"controlId":"app","viewPath":"com.perezjquim.ytc.pwa.view","controlAggregation":"pages"},"routes":[{"name":"Home","pattern":"","target":["CropNDownload"]},{"name":"CropNDownload","pattern":"CropNDownload","target":["CropNDownload"]}],"targets":{"Home":{"viewType":"XML","transition":"slide","controlAggregation":"pages","viewName":"Home"},"CropNDownload":{"viewType":"XML","transition":"slide","controlAggregation":"pages","viewName":"CropNDownload"}}}}}',
	"com/perezjquim/ytc/pwa/sw.js":function(){self.addEventListener("fetch",function(e){});
},
	"com/perezjquim/ytc/pwa/view/App.view.xml":'<mvc:View\n    controllerName="com.perezjquim.ytc.pwa.controller.App"\n    xmlns="sap.m"\n    xmlns:f="sap.f"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns:tnt="sap.tnt"\n><App id="app" /></mvc:View>\n',
	"com/perezjquim/ytc/pwa/view/CropNDownload.view.xml":'<mvc:View\n    controllerName="com.perezjquim.ytc.pwa.controller.CropNDownload"\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:l="sap.ui.layout"\n    xmlns:f="sap.ui.layout.form"\n    xmlns:mvc="sap.ui.core.mvc"\n><Page title="{i18n>CropNDownload}"><Wizard\n            id="ytc-wizard"\n            stepActivate="onPrepareVideo"\n        ><WizardStep\n                title="{i18n>step_params}"\n                validated="{= !!${video_info>/author} \n                    &amp;&amp;\n                    !!${prompt>/end_time}\n                    &amp;&amp;\n                    ${prompt>/end_time} !== \'00:00\' \n                }"\n            ><f:SimpleForm editable="true"><f:content><Label text="{i18n>url}" /><Input\n                            value="{prompt>/url}"\n                            change="onParamChanged"\n                        /></f:content></f:SimpleForm><f:SimpleForm\n                    visible="{= ${misc>/is_fetching_video_info} || !!${video_info>/author} }"\n                    busy="{misc>/is_fetching_video_info}"\n                ><f:content><Label text="{i18n>title}" /><Text text="{video_info>/title}" /><Label text="{i18n>author}" /><Text text="{video_info>/author}" /><Label text="{i18n>thumbnail}" /><Image\n                            height="20vh"\n                            src="{video_info>/thumbnail_url}"\n                        /><Label text="{i18n>duration}" /><Text text="{video_info>/duration}" /><Label text="{i18n>start_time}" /><MaskInput\n                            mask="TT:TT"\n                            placeholderSymbol="_"\n                            value="{prompt>/start_time}"\n                            change="onParamChanged"\n                        ><rules><MaskInputRule\n                                    maskFormatSymbol="T"\n                                    regex="[0-9]"\n                                /></rules></MaskInput><Label text="{i18n>end_time}" /><MaskInput\n                            mask="TT:TT"\n                            placeholderSymbol="_"\n                            value="{prompt>/end_time}"\n                            change="onParamChanged"\n                        ><rules><MaskInputRule\n                                    maskFormatSymbol="T"\n                                    regex="[0-9]"\n                                /></rules></MaskInput><Label text="{i18n>split}" /><HBox justifyContent="SpaceBetween"><CheckBox\n                                selected="{prompt>/split}"\n                                select="onParamChanged"\n                            /><MaskInput\n                                visible="{prompt>/split}"\n                                mask="TT:TT"\n                                placeholderSymbol="_"\n                                value="{prompt>/split_interval}"\n                                change="onParamChanged"\n                            ><rules><MaskInputRule\n                                        maskFormatSymbol="T"\n                                        regex="[0-9]"\n                                    /></rules></MaskInput></HBox></f:content></f:SimpleForm></WizardStep><WizardStep\n                title="{i18n>step_preview+dl}"\n                validated="false"\n            ><f:SimpleForm visible="{= !!${video_info>/author} }"><f:content><List items="{video_blobs>/}"><CustomListItem><HBox\n                                    backgroundDesign="Transparent"\n                                    justifyContent="SpaceBetween"\n                                    alignItems="Center"\n                                ><core:HTML\n                                        content="&lt;video class=\'z_video_preview\' src=\'{video_blobs>blob_url}\' controls /&gt;"\n                                    /><Button\n                                        icon="sap-icon://download"\n                                        press="onPressDownload"\n                                        type="Emphasized"\n                                    /></HBox></CustomListItem></List></f:content></f:SimpleForm></WizardStep></Wizard></Page></mvc:View>\n',
	"com/perezjquim/ytc/pwa/view/Home.view.xml":'<mvc:View \n    controllerName="com.perezjquim.ytc.pwa.controller.Home" \n    xmlns="sap.m"\n    xmlns:f="sap.f"\n    xmlns:mvc="sap.ui.core.mvc"><Page \n        title="{i18n>Home}"><f:GridContainer  \n            items="{ \n                path: \'navigation>/items\', \n                filters:\n                [\n                    { path: \'key\', operator: \'NE\', value1: \'Home\' }\n                ]\n            }"><f:items><GenericTile \n                    class="sapUiSmallMargin"\n                    header="{ path: \'navigation>key\', formatter: \'.getText\' }"\n                    press=".navTo(${ path: \'navigation>key\' })"><layoutData><f:GridContainerItemLayoutData minRows="2" columns="2" /></layoutData><TileContent><ImageContent src="{navigation>icon}" /></TileContent></GenericTile></f:items></f:GridContainer></Page></mvc:View>'
}});
